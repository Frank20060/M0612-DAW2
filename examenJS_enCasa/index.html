<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Gestión de Reservas - Gimnasio</title>
    <style>
      :root {
        --bg: #f5f7fa;
        --card: #ffffff;
        --muted: #6b7280;
        --accent: #2563eb;
        --glass: #eef2ff;
        --radius: 10px;
        --gap: 18px;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI",
          Roboto, "Helvetica Neue", Arial;
        background: var(--bg);
        color: #111827;
        padding: 20px;
      }

      .app {
        max-width: 1300px;
        margin: 0 auto;
        display: flex;
        gap: var(--gap);
        align-items: flex-start;
      }

      /* Columna izquierda */
      .left {
        width: 380px;
        background: var(--card);
        border-radius: var(--radius);
        padding: 18px;
        box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
        transition: all 0.25s ease;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .left.oculto {
        display: none; /* no ocupa espacio */
      }

      .btn-toggle {
        align-self: flex-start;
        background: #374151;
        color: #fff;
        border: none;
        padding: 8px 14px;
        margin: 12px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }
      .btn-toggle:active {
        transform: translateY(1px);
      }

      h2.section-title {
        margin: 0 0 6px 0;
        font-size: 18px;
        color: #0f172a;
      }

      .activities-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
      }
      .activities-table thead th {
        text-align: left;
        padding: 10px 8px;
        color: var(--muted);
        font-weight: 700;
        font-size: 13px;
        border-bottom: 1px solid #eef2f6;
      }
      .activities-table td {
        padding: 10px 8px;
        vertical-align: middle;
        border-bottom: 1px solid #f1f5f9;
      }
      .activity-row:hover {
        background: #fbfdff;
      }

      .pic {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 6px;
        background: #eef2f6;
        display: block;
      }

      .meta {
        display: flex;
        flex-direction: column;
        gap: 4px;
        font-size: 13px;
      }
      .badge {
        display: inline-block;
        font-size: 12px;
        padding: 6px 8px;
        border-radius: 999px;
        background: #f1f5f9;
        color: #374151;
        font-weight: 600;
      }

      /* Columna derecha */
      .right {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: var(--gap);
      }

      /* Barra de control */
      .control-bar {
        background: var(--card);
        padding: 14px;
        border-radius: var(--radius);
        display: flex;
        gap: 12px;
        align-items: center;
        box-shadow: 0 6px 18px rgba(15, 23, 42, 0.05);
        flex-wrap: wrap;
      }
      .control-bar select,
      .control-bar button {
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid #e6eef8;
        background: #fff;
        font-size: 14px;
      }
      .control-bar select {
        min-width: 160px;
      }
      .control-bar .btn-register {
        background: var(--accent);
        color: white;
        border: none;
        padding: 10px 18px;
        font-weight: 700;
        cursor: pointer;
      }
      .control-bar .btn-register:active {
        transform: translateY(1px);
      }

      /* Grid de franjas */
      .slots {
        background: var(--glass);
        padding: 18px;
        border-radius: var(--radius);
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 14px;
        box-shadow: 0 6px 18px rgba(15, 23, 42, 0.03);
      }

      @media (max-width: 920px) {
        .slots {
          grid-template-columns: repeat(2, 1fr);
        }
      }
      @media (max-width: 640px) {
        .app {
          flex-direction: column;
        }
        .left {
          width: 100%;
        }
        .slots {
          grid-template-columns: 1fr;
        }
      }

      .slot {
        background: var(--card);
        border-radius: 12px;
        padding: 14px;
        min-height: 120px;
        box-shadow: 0 8px 22px rgba(2, 6, 23, 0.06);
        position: relative;
        cursor: pointer;
        transition: transform 0.15s ease, box-shadow 0.15s ease,
          background 0.15s ease;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .slot:hover {
        transform: translateY(-6px) scale(1.01);
        box-shadow: 0 14px 34px rgba(2, 6, 23, 0.09);
        background: linear-gradient(180deg, #ffffff, #fbfdff);
      }

      .slot .time {
        font-weight: 800;
        color: var(--accent);
        font-size: 18px;
      }
      .slot .empty {
        color: var(--muted);
        font-size: 13px;
        margin-top: 6px;
      }

      .reservations-list {
        display: flex;
        flex-direction: column;
        gap: 6px;
        margin-top: 6px;
        overflow: auto;
        max-height: 180px;
        padding-right: 6px;
      }
      .reservation-item {
        font-size: 13px;
        padding: 6px 8px;
        border-radius: 8px;
        background: #f8fafc;
        border: 1px solid #eef2f8;
      }

      .slot .badge-count {
        position: absolute;
        right: 12px;
        top: 12px;
        background: #111827;
        color: white;
        font-size: 12px;
        padding: 6px 8px;
        border-radius: 999px;
      }

      /* Modal */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(2, 6, 23, 0.45);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        padding: 20px;
      }
      .modal-overlay.show {
        display: flex;
      }
      .modal-card {
        width: 100%;
        max-width: 760px;
        background: var(--card);
        border-radius: 12px;
        padding: 18px;
        max-height: 86vh;
        overflow: auto;
        box-shadow: 0 12px 40px rgba(2, 6, 23, 0.3);
      }
      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
      }
      .modal-header h3 {
        margin: 0;
      }
      .close-btn {
        background: none;
        border: 0;
        font-size: 22px;
        cursor: pointer;
        color: var(--muted);
      }

      .details-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 12px;
      }
      .details-table th {
        text-align: left;
        padding: 10px;
        background: #f8fafc;
        border-bottom: 2px solid #eef2f8;
        font-size: 13px;
        color: var(--muted);
      }
      .details-table td {
        padding: 10px;
        border-bottom: 1px solid #f1f5f9;
        font-size: 14px;
      }
      .total-row {
        text-align: right;
        font-weight: 800;
        padding-top: 10px;
        font-size: 16px;
        color: var(--accent);
      }

      /* small helpers */
      .muted {
        color: var(--muted);
      }
      .flex {
        display: flex;
        align-items: center;
        gap: 10px;
      }
    </style>
  </head>
  <body>
    <!-- BOTÓN FUERA DEL ASIDE -->

    <div class="app">
      <!-- Columna Izquierda -->
      <div>
        <button class="btn-toggle" id="toggleBtn">
          Mostrar/Ocultar Lista de Actividades
        </button>
        <aside class="left" id="leftCol">
          <div>
            <h2 class="section-title">Lista de actividades</h2>
            <table
              class="activities-table"
              aria-describedby="lista-actividades"
            >
              <thead>
                <tr>
                  <th>Actividad</th>
                  <th>Duración</th>
                  <th>Intensidad</th>
                  <th>Foto</th>
                </tr>
              </thead>
              <tbody id="activitiesTbody">
                <!-- populated por JS -->
              </tbody>
            </table>
          </div>
        </aside>
      </div>

      <!-- Columna Derecha -->
      <main class="right">
        <div class="control-bar" aria-label="Barra control reservas">
          <select
            id="selectActivity"
            aria-label="Seleccionar actividad"
          ></select>
          <select id="selectPeople" aria-label="Seleccionar número de personas">
            <option value="1">1 persona</option>
            <option value="2">2 personas</option>
            <option value="3">3 personas</option>
            <option value="4">4 personas</option>
            <option value="5">5 personas</option>
          </select>
          <select id="selectSlot" aria-label="Seleccionar franja horario">
            <!-- populated por JS -->
          </select>
          <button class="btn-register" id="btnRegister">
            Registrar Reserva
          </button>
        </div>

        <section
          class="slots"
          id="slotsContainer"
          aria-label="Franjas horarias"
        >
          <!-- tarjetas creadas por JS -->
        </section>
      </main>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal">
      <div
        class="modal-card"
        role="dialog"
        aria-modal="true"
        aria-labelledby="modalTitle"
      >
        <div class="modal-header">
          <h3 id="modalTitle">Detalles de reservas</h3>
          <div>
            <button class="close-btn" id="closeModal" title="Cerrar">✕</button>
          </div>
        </div>
        <div id="modalBody">
          <!-- tabla y total -->
        </div>
      </div>
    </div>


    <!-- imagenes


    https://www.webconsultas.com/sites/default/files/styles/wch_image_schema/public/media/0d/temas/yoga.jpg     //yoga
  https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQVVl5HJgLoKahN-xu4nP0yhDamh_mHgk21YA&s    //spinning
  https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSVpdTPoYBgbWYtn8JYSm0Pt-ikKyY30LFn5A&s    //crossfit
  https://images.ctfassets.net/ipjoepkmtnha/5nTW9GvNYKtjJukcotDgji/c9cffb3fb04dfe4e7407153f371054dd/TG_REFORM_TechnoGym_Classe_-_12_1198_ADV__1_.jpg  //pilates
  https://static.vecteezy.com/system/resources/thumbnails/000/126/255/small/free-zumba-dancers-vector.jpg   //zumba 
    
    
    
    -->

    <script>
      /* Datos iniciales según enunciado */
      const activities = [
        {
          id: "yoga",
          name: "Yoga Suave",
          duration: 60,
          intensity: "Baja",
          photo:
            "https://www.webconsultas.com/sites/default/files/styles/wch_image_schema/public/media/0d/temas/yoga.jpg",
        },
        {
          id: "spinning",
          name: "Spinning Intensivo",
          duration: 45,
          intensity: "Alta",
          photo:
            "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQVVl5HJgLoKahN-xu4nP0yhDamh_mHgk21YA&s",
        },
        {
          id: "crossfit",
          name: "CrossFit Funcional",
          duration: 50,
          intensity: "Alta",
          photo:
            "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSVpdTPoYBgbWYtn8JYSm0Pt-ikKyY30LFn5A&s",
        },
        {
          id: "pilates",
          name: "Pilates Máquinas",
          duration: 55,
          intensity: "Media",
          photo:
            "https://images.ctfassets.net/ipjoepkmtnha/5nTW9GvNYKtjJukcotDgji/c9cffb3fb04dfe4e7407153f371054dd/TG_REFORM_TechnoGym_Classe_-_12_1198_ADV__1_.jpg",
        },
        {
          id: "zumba",
          name: "Zumba Fitness",
          duration: 40,
          intensity: "Media",
          photo:
            "https://static.vecteezy.com/system/resources/thumbnails/000/126/255/small/free-zumba-dancers-vector.jpg",
        },
      ];

      const timeSlots = ["09:00", "11:00", "13:00", "17:00", "19:00"];

      /* Estructura para guardar reservas por franja */
      const reservations = {
        "09:00": [],
        "11:00": [],
        "13:00": [],
        "17:00": [],
        "19:00": [],
      };

      /* Referencias DOM */
      const activitiesTbody = document.getElementById("activitiesTbody");
      const selectActivity = document.getElementById("selectActivity");
      const selectSlot = document.getElementById("selectSlot");
      const slotsContainer = document.getElementById("slotsContainer");
      const toggleBtn = document.getElementById("toggleBtn");
      const leftCol = document.getElementById("leftCol");
      const btnRegister = document.getElementById("btnRegister");
      const modal = document.getElementById("modal");
      const modalBody = document.getElementById("modalBody");
      const closeModal = document.getElementById("closeModal");

      function init() {
        populateActivitiesList();
        populateSelects();
        renderSlots();
        attachEvents();
      }

      function populateActivitiesList() {
        activitiesTbody.innerHTML = "";
        activities.forEach((act) => {
          const tr = document.createElement("tr");
          tr.classList.add("activity-row");
          tr.innerHTML = `
        <td>${act.name} min</td>
      <td>${act.duration} min</td>
      <td>${act.intensity}</td>
      <td><img src="${act.photo}" alt="${act.name}" class="pic" style="width:100px;height:100px"></td>
    `;
          activitiesTbody.appendChild(tr);
        });
      }

      function populateSelects() {
        selectActivity.innerHTML = activities
          .map((a) => `<option value="${a.id}">${a.name}</option>`)
          .join("");
        selectSlot.innerHTML = timeSlots
          .map((t) => `<option value="${t}">${t}</option>`)
          .join("");
      }

      function renderSlots() {
        slotsContainer.innerHTML = "";
        timeSlots.forEach((slot) => {
          const div = document.createElement("div");
          div.className = "slot";
          div.dataset.slot = slot;
          div.innerHTML = `
      <div class="time">${slot}</div>
      <div class="badge-count" aria-hidden="true">0</div>
      <div class="reservations-list" aria-live="polite">
        <div class="empty">Sin reservas (vacío)</div>
      </div>
    `;
          // click para abrir modal con detalles
          div.addEventListener("click", (e) => {
            // no queremos que pulsar el scroll dentro dispare el modal múltiples veces
            openModalForSlot(slot);
          });
          slotsContainer.appendChild(div);
        });
        refreshSlotDisplays();
      }

      function refreshSlotDisplays() {
        timeSlots.forEach((slot) => {
          const node = slotsContainer.querySelector(
            `.slot[data-slot="${slot}"]`
          );
          const list = node.querySelector(".reservations-list");
          const badge = node.querySelector(".badge-count");
          list.innerHTML = "";
          const arr = reservations[slot];
          if (arr.length === 0) {
            list.innerHTML = '<div class="empty">Sin reservas (vacío)</div>';
            badge.textContent = "0";
          } else {
            badge.textContent = String(arr.length);
            arr.forEach((r) => {
              const it = document.createElement("div");
              it.className = "reservation-item";
              it.textContent = `${r.name} x${r.people} personas`;
              list.appendChild(it);
            });
          }
        });
      }

      /* Toggle columna izquierda */
      function attachEvents() {
        toggleBtn.addEventListener("click", () => {
          leftCol.classList.toggle("oculto");
          toggleBtn.textContent = leftCol.classList.contains("oculto")
            ? "Mostrar Lista de Actividades"
            : "Ocultar Lista de Actividades";
        });

        btnRegister.addEventListener("click", (e) => {
          e.preventDefault();
          const actId = selectActivity.value;
          const people = Number(document.getElementById("selectPeople").value);
          const slot = selectSlot.value;
          registerReservation(actId, people, slot);
        });

        closeModal.addEventListener("click", () =>
          modal.classList.remove("show")
        );
        modal.addEventListener("click", (e) => {
          if (e.target === modal) modal.classList.remove("show");
        });

        // tecla Escape cierra modal
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") modal.classList.remove("show");
        });
      }

      /* Registrar reserva: añade al array y refresca UI */
      function registerReservation(actId, people, slot) {
        const act = activities.find((a) => a.id === actId);
        if (!act) return alert("Actividad no encontrada");
        const entry = {
          id: cryptoRandomId(),
          name: act.name,
          activityId: act.id,
          people,
          duration: act.duration,
        };
        reservations[slot].push(entry);
        refreshSlotDisplays();
      }

      /* Abrir modal con detalles y total */
      function openModalForSlot(slot) {
        const arr = reservations[slot];
        modalBody.innerHTML = ""; // limpiar
        const header = document.getElementById("modalTitle");
        header.textContent = `Detalles de reservas para las ${slot}`;

        if (arr.length === 0) {
          modalBody.innerHTML = `<p class="muted">No hay reservas en esta franja.</p>`;
          modal.classList.add("show");
          return;
        }

        // construir tabla
        const table = document.createElement("table");
        table.className = "details-table";
        table.innerHTML = `
    <thead>
      <tr>
        <th>Actividad</th>
        <th>Nº personas</th>
        <th>Duración (min)</th>
        <th>Carga (min)</th>
      </tr>
    </thead>
    <tbody></tbody>
  `;
        const tbody = table.querySelector("tbody");

        let total = 0;
        arr.forEach((r) => {
          const carga = r.duration * r.people;
          total += carga;
          const tr = document.createElement("tr");
          tr.innerHTML = `
      <td>${r.name}</td>
      <td>${r.people}</td>
      <td>${r.duration}</td>
      <td>${carga}</td>
    `;
          tbody.appendChild(tr);
        });

        const totalDiv = document.createElement("div");
        totalDiv.className = "total-row";
        totalDiv.textContent = `Carga total de minutos: ${total} min`;

        modalBody.appendChild(table);
        modalBody.appendChild(totalDiv);
        modal.classList.add("show");
      }

      /* ID aleatorio simple */
      function cryptoRandomId() {
        return Math.random().toString(36).slice(2, 9);
      }

      /* init */
      init();
    </script>
  </body>
</html>
